<div class="display-container">
  <%# Confirms if the user has reviewed the site or not based on whether their email has been added to the 
  useremails array which contains the emails for the users that have reviewed this specific show.  %>
  <% @reviewed = false %>
  <% @ownreview = false %>
  <%# Gets username for reviews by userreviews for the show.  %>
  <%# Also pushes user emails to array. If email there, the user cannot make a second rating.  %>
  
  <% @usernames = [] %>
  <% @useremails = [] %>
  
  <% @userreviews.each do |userreview| %>
    <% @users = User.where(id: userreview.user_id) %>
    <% @users.each do |user| %>
      <% @usernames.push(user.username) %>
      <% @useremails.push(user.email) %>
      <% if @useremails.include?(current_user.email) %>
        <% @reviewed = true %>
      <% else %>
        <% @reviewed = false %>
        <% @useremails %>
      <% end %>
    <% end %>
  <% end %>
<%# Condition to check if the person who created the show is the current user. %>
  <% @self = User.where(id: @show.user_id) %>

  <h2><span class="display-title"><%= @show.title %></h2></span>
  <p><span class="label">Genre</span><br/><br /><%= @show.genre %></p>
  <p><span class="label">Performer</span><br/><br /><%= @show.performer %></p>
  <p><span class="label">Description</span><br/><br /><%= @show.description %></p>
  <p><span class="label">Image</span><br/><br /></p>
  <br />

  <% if @show.imageup.attached? %>
    <img src="<%= url_for(@show.imageup) %>">
    <br />
  <% end %>
<%# Checks as to whether the current user has already reviewed the show.  %>
  <% if @reviewed == true %>
    <p><span class="label">You have reviewed this show</span></p>
  <%# Checks as to whether the current user has created the show. They shouldn't be able to review the show.  %>
  <% elsif @self.blank? %>
    <p><%= render 'shows/review_form' %></p>
  <% end %>

  <br /><br />
  <div class="reviews">
 

    <% if @userreviews.present? %>
     <h2>Reviews:</h2>
      <% @userreviews.each do |r| %>
  <div class="review">
          <p><span class="label">Rating:</span> 
                    &nbsp;&nbsp;
          <strong><%= r.rating %></strong></p>
          <p><span class="label">Reviewer:</span>
          <br /> <%=@usernames[0]%></p>
          <% @usernames.shift %>
          <p><span class="label">Review:</span> 
          <br /><%= r.review %></p>
          </div>
     
      <% end %>
      <% else %>
      <p>There are currently no reviews for this show</p>

    <% end %>
    </div>
  </ul>
  <br/><br/>
</div>
<br /><br />
